Здесь описывается способ некоторого ускорения xrLC/xrDO_Light. Суть
метода в балансировке числа нитей по числу процессоров.

Помимо исправления бинарников, можно использовать внешний диспетчер
(ttuner).

файл: bins\compiler\xrLC.exe
MD5: 14047c6e0cd7e034548db245da577bd2
эффект: на T2500 значительный (~40%)

Radiosity-Solver
создаёт две нити, пока не трогаем

LIGHT: MU
0x000076d7: 0x02 -> 0x00	shr eax,2 -> shr eax,0	; log2(NUM_THREADS)
0x00007813: 0x04 -> 0x01	cmp esi,4 -> cmp esi,1	; NUM_THREADS

LIGHT: Vertex (не проверено! особого смысла менять нет, так как стадия короткая сама по себе)
0x00048da1: 0x04 -> 0x04	cmp edi,4 -> cmp edi,4

LIGHT: LMaps
0x0004972c: 0x06 -> 0x02	cmp ebp,6 -> cmp ebp,2	; NCPU

LIGHT: Implicit
0x00050e0d: 0x03 -> 0x01	shr ebx,3 -> shr ebx,1	; log2(NCPU)
0x00050f1e: 0x08 -> 0x02	cmp esi,8 -> cmp esi,2	; NCPU


файл: bins\compiler\xrDO_Light.exe
MD5: e37fac70796fce86e02f78e782b7b52b
эффект: на T2500 значительный (ot ~30% до ~100%)

0x00006639: 0xb8 -> 0x89	mov ebp,ecx
0x0000663a: 0xab -> 0xcd
0x0000663b: 0xaa -> 0xc1	shr ebp,1		; log2(NCPU)
0x0000663c: 0xaa -> 0xed
0x0000663d: 0xaa -> 0x01
0x0000663e: 0xf7 -> 0xb8	mov eax,1		; NCPU-1
0x0000663f: 0xe1 -> 0x01
0x00006640: 0x53 -> 0x00
0x00006641: 0x55 -> 0x00
0x00006642: 0x8b -> 0x00
0x00006643: 0xea -> 0xf7	mul ebp
0x00006644: 0xd1 -> 0xe5
0x00006645: 0xed -> 0x90	nop

0x00006647: 0x8d -> 0x90	nop
0x00006648: 0x44 -> 0x90	nop
0x00006649: 0x2d -> 0x90	nop
0x0000664a: 0x00 -> 0x90	nop

0x00006680: 0x83 -> 0x83	cmp ebx,2 -> cmp ebx,1	; NCPU-1
0x00006681: 0xfb -> 0xfb
0x00006682: 0x02 -> 0x01

0x000066e5: 0x83 -> 0x83	cmp ebx,3 -> cmp ebx,2	; NCPU
0x000066e6: 0xfb -> 0xfb
0x000066e7: 0x03 -> 0x02


файл: xrAI от 2215 (из архива aiwrapper, то есть после editbin)
MD5: e4871395a7378559f2a4934896f37dfe
эффект: на T2500 нету

0x00009c45: 0xb8 -> 0x89	mov ebx,ecx
0x00009c46: 0xab -> 0xcb
0x00009c47: 0xaa -> 0xc1	shr ebx,1		; log2(NCPU)
0x00009c48: 0xaa -> 0xeb
0x00009c49: 0xaa -> 0x01
0x00009c4a: 0xf7 -> 0x83	and ecx,1		; NCPU-1
0x00009c4b: 0xe1 -> 0xe1
0x00009c4c: 0x8b -> 0x01
0x00009c4d: 0xda -> 0x01	add ecx,ebx
0x00009c4e: 0xd1 -> 0xd9
0x00009c4f: 0xeb -> 0x90	nop

0x00009c71: 0x8d -> 0x90	nop
0x00009c72: 0x0c -> 0x90	nop
0x00009c73: 0x1b -> 0x90	nop
0x00009c74: 0x2b -> 0x89	mov eax,ecx
0x00009c75: 0xc1 -> 0xc8

0x00009c80: 0x83 -> 0x83	cmp esi,2 -> cmp esi,1	; NCPU-1
0x00009c81: 0xfe -> 0xfe
0x00009c82: 0x02 -> 0x01

0x00009cd6: 0x83 -> 0x83	cmp esi,3 -> cmp esi,2	; NCPU
0x00009cd7: 0xfe -> 0xfe
0x00009cd8: 0x03 -> 0x02
